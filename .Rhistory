library(readr)
population_data <- read_csv("population_data.csv")
View(population_data)
# Read the data
data <- read.csv("population_data.csv", stringsAsFactors = FALSE)
# Create function to assign continents
assign_continent <- function(country) {
country_lower <- tolower(country)
# Asia
if (country_lower %in% c("india", "china", "indonesia", "pakistan", "bangladesh",
"japan", "philippines", "vietnam", "iran", "turkey",
"thailand", "myanmar", "south korea", "iraq", "afghanistan",
"yemen", "uzbekistan", "malaysia", "saudi arabia", "nepal",
"north korea", "syria", "sri lanka", "taiwan", "kazakhstan",
"kyrgyzstan", "tajikistan", "turkmenistan", "hong kong",
"israel", "jordan", "united arab emirates", "lebanon",
"state of palestine", "oman", "kuwait", "qatar", "bahrain",
"mongolia", "bhutan", "macao", "singapore", "timor-leste",
"cyprus", "brunei", "maldives", "cambodia", "laos")) {
return("Asia")
}
# Africa
else if (country_lower %in% c("nigeria", "ethiopia", "egypt", "dr congo", "tanzania",
"south africa", "kenya", "sudan", "uganda", "algeria",
"morocco", "ghana", "mozambique", "madagascar",
"côte d'ivoire", "cameroon", "niger", "mali",
"burkina faso", "malawi", "zambia", "chad", "somalia",
"senegal", "guinea", "benin", "rwanda", "burundi",
"tunisia", "south sudan", "togo", "sierra leone",
"libya", "congo", "liberia", "central african republic",
"mauritania", "namibia", "botswana", "lesotho",
"gambia", "gabon", "guinea-bissau", "equatorial guinea",
"mauritius", "eswatini", "djibouti", "comoros",
"eritrea", "cape verde", "são tomé & principe",
"seychelles", "angola", "zimbabwe", "south sudan",
"cabo verde")) {
return("Africa")
}
# Europe
else if (country_lower %in% c("united kingdom", "france", "italy", "spain", "ukraine",
"poland", "germany", "netherlands", "belgium", "greece",
"portugal", "sweden", "czech republic (czechia)",
"hungary", "austria", "belarus", "switzerland",
"romania", "denmark", "finland", "norway", "slovakia",
"ireland", "croatia", "georgia", "bosnia and herzegovina",
"moldova", "armenia", "lithuania", "albania", "slovenia",
"latvia", "north macedonia", "estonia", "montenegro",
"luxembourg", "malta", "iceland", "andorra",
"liechtenstein", "monaco", "san marino", "vatican",
"faroe islands", "gibraltar", "isle of man", "serbia",
"bulgaria")) {
return("Europe")
}
# North America
else if (country_lower %in% c("united states", "canada", "mexico", "guatemala",
"honduras", "cuba", "haiti", "dominican republic",
"el salvador", "nicaragua", "costa rica", "panama",
"jamaica", "puerto rico", "trinidad and tobago",
"bahamas", "belize", "barbados", "saint lucia",
"grenada", "antigua and barbuda", "dominica",
"saint kitts & nevis", "saint vincent & grenadines")) {
return("North America")
}
# South America
else if (country_lower %in% c("brazil", "colombia", "argentina", "peru", "venezuela",
"chile", "ecuador", "bolivia", "paraguay", "uruguay",
"guyana", "suriname", "french guiana", "falkland islands")) {
return("South America")
}
# Oceania
else if (country_lower %in% c("australia", "papua new guinea", "new zealand", "fiji",
"solomon islands", "vanuatu", "samoa", "kiribati",
"micronesia", "tonga", "marshall islands", "palau",
"nauru", "tuvalu", "cook islands", "niue", "tokelau",
"guam", "new caledonia", "french polynesia",
"american samoa", "northern mariana islands",
"wallis & futuna")) {
return("Oceania")
}
# Default
else {
return("Other")
}
}
# Add continent column to the data
data$Continent <- sapply(data$Country..or.dependency., assign_continent)
# Check the structure
cat("Data now has", ncol(data), "columns\n")
cat("New column 'Continent' added\n")
# Show first few rows with country and continent
cat("\nFirst 20 countries with their continents:\n")
print(data[1:20, c("Country..or.dependency.", "Continent")])
# Count how many countries in each continent
cat("\nNumber of countries per continent:\n")
continent_counts <- table(data$Continent)
print(continent_counts)
# To see which countries are growing (positive Yearly Change), we need to clean the Yearly Change column
# Remove the % sign and convert to numeric
data$Yearly_Change_Numeric <- as.numeric(gsub("%", "", data$Yearly.Change))
# Now you can analyze which continents are growing
cat("\nAverage yearly change by continent:\n")
avg_growth_by_continent <- aggregate(Yearly_Change_Numeric ~ Continent, data = data, mean)
print(avg_growth_by_continent)
# Find which continents have positive growth on average
cat("\nContinents with positive average growth:\n")
positive_growth <- avg_growth_by_continent[avg_growth_by_continent$Yearly_Change_Numeric > 0, ]
print(positive_growth)
# Optional: Save the updated data
# write.csv(data, "population_data_with_continents.csv", row.names = FALSE)
# For your specific analysis of which continents are growing:
cat("\n--- For your analysis: ---\n")
cat("1. Data now has 'Continent' column added\n")
cat("2. Use data$Continent to group your analysis\n")
cat("3. Use data$Yearly_Change_Numeric for growth rates (positive = growing)\n")
cat("4. You can now analyze by continent using: aggregate(Yearly_Change_Numeric ~ Continent, data, mean)\n")
View(population_data)
View(data)
View(avg_growth_by_continent)
View(assign_continent)
View(assign_continent)
View(assign_continent)
View(assign_continent)
View(assign_continent)
library(readr)
population_data <- read_csv("population_data.csv")
View(population_data)
source("~/Documents/University Of Hertfordshire/Team Research and Development project/word_population_A48/DS354_R_Script.R")
View(data)
View(population_data)
View(data)
View(population_data)
View(data)
library(readr)
population_data <- read_csv("population_data.csv")
View(population_data)
install.packages("tidyverse")  # For data manipulation
install.packages("countrycode") # For country-to-continent mapping
install.packages("ggplot2")     # For visualizations
library(tidyverse)
library(countrycode)
library(ggplot2)
library(knitr)
cat("✅ Libraries loaded successfully!\n")
library(readr)
population_data <- read_csv("population_data.csv")
View(population_data)
install.packages("tidyverse")  # For data manipulation
install.packages("countrycode") # For country-to-continent mapping
install.packages("ggplot2")     # For visualizations
library(tidyverse)
library(countrycode)
library(ggplot2)
cat("✅ Libraries loaded successfully!\n")
# ===  LOADING AND EXPLORING OUR DATASET ===
population_data <- read.csv("population_data.csv")
cat("Total countries:", nrow(population_data), "\n")
print(names(population_data))
str(population_data)
head(population_data, 3)
missing_values <- sum(is.na(population_data))
cat("\nTotal missing values:", missing_values, "\n")
source("~/Documents/University Of Hertfordshire/Team Research and Development project/word_population_A48/Loading and Exploring The Data.R")
library(readr)
source("~/Documents/University Of Hertfordshire/Team Research and Development project/word_population_A48/Loading and Exploring The Data.R")
source("~/Documents/University Of Hertfordshire/Team Research and Development project/word_population_A48/Loading and Exploring The Data.R")
library(readr)
population_data <- read_csv("population_data.csv")
View(population_data)
source("~/Documents/University Of Hertfordshire/Team Research and Development project/word_population_A48/Loading and Exploring The Data.R")
population_data <- read_csv("population_data.csv")
cat("Total countries:", nrow(population_data), "\n")
cat("Variables available:\n")
print(names(population_data))
str(population_data)
head(population_data, 3)
missing_values <- sum(is.na(population_data))
cat("\nTotal missing values:", missing_values, "\n")
# === STEP 2.3: CREATE GROWTH STATUS VARIABLE ===
# Convert Yearly Change from character to numeric (remove % sign)
population_data$Yearly_Change_Numeric <- as.numeric(gsub("%", "", population_data$`Yearly Change`))
population_data$Yearly_Change_Numeric <- as.numeric(gsub("%", "", population_data$`Yearly Change`))
# Create Growth Status variable
population_data <- population_data %>%
mutate(
Growth_Status = ifelse(Yearly_Change_Numeric > 0, "Growing", "Declining"),
Growth_Status = factor(Growth_Status, levels = c("Growing", "Declining"))
)
install.packages("dplyr")
library(dplyr)
# === CREATING GROWTH STATUS VARIABLE ===
# Creating Yearly_Change_Numeric (remove % sign)
population_data$Yearly_Change_Numeric <- as.numeric(gsub("%", "", population_data$`Yearly Change`))
# Creating Growth_Status variable (FIXED VERSION)
population_data <- population_data %>%
mutate(
Growth_Status = ifelse(Yearly_Change_Numeric > 0, "Growing", "Declining"),
Growth_Status = factor(Growth_Status, levels = c("Growing", "Declining"))
)
cat("Declining countries:", sum(population_data$Growth_Status == "Declining"), "\n")
cat("Growing countries:", sum(population_data$Growth_Status == "Growing"), "\n")
library(readr)
population_data <- read_csv("population_data.csv")
View(population_data)
source("~/Documents/University Of Hertfordshire/Team Research and Development project/word_population_A48/Environtment_setup_and_Loading_dataset.R")
source("~/Documents/University Of Hertfordshire/Team Research and Development project/word_population_A48/Environtment_setup_and_Loading_dataset.R")
source("~/Documents/University Of Hertfordshire/Team Research and Development project/word_population_A48/Environtment_setup_and_Loading_dataset.R")
install.packages("tidyverse")  # For data manipulation
install.packages("countrycode") # For country-to-continent mapping
install.packages("ggplot2")     # For visualizations
install.packages("dplyr")
# Load libraries
library(tidyverse)
library(countrycode)
library(ggplot2)
library(dplyr)
cat("✅ Libraries loaded successfully!\n")
population_data <- read.csv("population_data.csv")
# Basic dataset information
cat("=== DATASET OVERVIEW ===\n")
cat("Total countries:", nrow(population_data), "\n")
cat("Variables available:\n")
print(names(population_data))
# View structure of the dataset
str(population_data)
head(population_data, 3)
# Check for missing values
missing_values <- sum(is.na(population_data))
cat("\nTotal missing values:", missing_values, "\n")
cat("=== CHECKING YEARLY CHANGE VALUES ===\n")
print(head(population_data$Yearly.Change, 10))
# Converting Yearly Change to numeric (handle special minus sign)
# Replacing the special minus sign with regular minus
population_data$Yearly_Change_Numeric <- gsub("−", "-", population_data$Yearly.Change)
# Removing the % sign
population_data$Yearly_Change_Numeric <- gsub("%", "", population_data$Yearly_Change_Numeric)
# Converting to numeric
population_data$Yearly_Change_Numeric <- as.numeric(population_data$Yearly_Change_Numeric)
# Creating Growth Status
population_data$Growth_Status <- ifelse(
+     population_data$Yearly_Change_Numeric > 0,
+     "Growing",
+     "Declining")
# Creating Growth Status
population_data$Growth_Status <- ifelse(
population_data$Yearly_Change_Numeric > 0,
"Growing",
"Declining")
table(population_data$Growth_Status)
# Testing with the first few rows
test_rows <- population_data[1:10, ]
test_rows$Growth_Status <- ifelse(
as.numeric(gsub("%", "", gsub("−", "-", test_rows$Yearly.Change))) > 0,
"Growing",
"Declining")
cat("=== TEST RESULTS (First 10 rows) ===\n")
View(population_data)
# First, let's create the continent mapping using countrycode
population_data$Continent <- countrycode(
sourcevar = population_data$Country..or.dependency.,
origin = "country.name",
destination = "continent",
warn = FALSE
)
# Handle any countries that couldn't be mapped
na_continent <- sum(is.na(population_data$Continent))
if(na_continent > 0) {
cat("Countries without continent assignment:", na_continent, "\n")
# Assign "Other" for unmapped countries
population_data$Continent[is.na(population_data$Continent)] <- "Other"
}
# Check continent distribution
cat("\n=== CONTINENT DISTRIBUTION ===\n")
continent_table <- table(population_data$Continent)
print(continent_table)
library(readr)
population_data <- read_csv("population_data.csv")
View(population_data)
install.packages("tidyverse")  # For data manipulation
install.packages("countrycode") # For country-to-continent mapping
install.packages("ggplot2")     # For visualizations
install.packages("dplyr")
install.packages("viridis")
# Load libraries
library(tidyverse)
library(countrycode)
library(ggplot2)
library(dplyr)
library(viridis)
cat("✅ Libraries loaded successfully!\n")
population_data <- read.csv("population_data.csv")
# Basic dataset information
cat("=== DATASET OVERVIEW ===\n")
cat("Total countries:", nrow(population_data), "\n")
cat("Variables available:\n")
print(names(population_data))
# View structure of the dataset
str(population_data)
head(population_data, 3)
# Check for missing values
missing_values <- sum(is.na(population_data))
cat("\nTotal missing values:", missing_values, "\n")
cat("=== CHECKING YEARLY CHANGE VALUES ===\n")
print(head(population_data$Yearly.Change, 10))
# Converting Yearly Change to numeric (handle special minus sign)
# Replacing the special minus sign with regular minus
population_data$Yearly_Change_Numeric <- gsub("−", "-", population_data$Yearly.Change)
# Removing the % sign
population_data$Yearly_Change_Numeric <- gsub("%", "", population_data$Yearly_Change_Numeric)
# Converting to numeric
population_data$Yearly_Change_Numeric <- as.numeric(population_data$Yearly_Change_Numeric)
# Creating Growth Status
population_data$Growth_Status <- ifelse(
population_data$Yearly_Change_Numeric > 0,
"Growing",
"Declining")
table(population_data$Growth_Status)
# Testing with the first few rows
test_rows <- population_data[1:10, ]
test_rows$Growth_Status <- ifelse(
as.numeric(gsub("%", "", gsub("−", "-", test_rows$Yearly.Change))) > 0,
"Growing",
"Declining")
cat("=== TEST RESULTS (First 10 rows) ===\n")
print(test_rows[, c("Country..or.dependency.", "Yearly.Change", "Growth_Status")])
# First, let's create the continent mapping using countrycode
population_data$Continent <- countrycode(
sourcevar = population_data$Country..or.dependency.,
origin = "country.name",
destination = "continent",
warn = FALSE
)
# Handle any countries that couldn't be mapped
na_continent <- sum(is.na(population_data$Continent))
if(na_continent > 0) {
cat("Countries without continent assignment:", na_continent, "\n")
# Assign "Other" for unmapped countries
population_data$Continent[is.na(population_data$Continent)] <- "Other"
}
# Check continent distribution
cat("\n=== CONTINENT DISTRIBUTION ===\n")
continent_table <- table(population_data$Continent)
print(continent_table)
# Calculate average growth percentage globally
avg_growing <- mean(population_data$Growth_Status == "Growing") * 100
# Create data for diverging bars
diverging_data <- population_data %>%
group_by(Continent) %>%
summarise(
Total = n(),
Growing = sum(Growth_Status == "Growing"),
Percent_Growing = Growing / Total * 100,
Above_Average = Percent_Growing > avg_growing
)
diverging_colors <- c("#E74C3C", "#3498DB") # Red-Blue gradient for above/below
diverging_bar <- ggplot(diverging_data, aes(x = Continent)) +
# Bars for percent growing
geom_bar(
aes(y = Percent_Growing, fill = Above_Average),
stat = "identity",
width = 0.7
) +
# Reference line for average
geom_hline(
yintercept = avg_growing,
color = "#2C3E50",
linetype = "dashed",
size = 1,
alpha = 0.7
) +
# Label for average line
annotate(
"text",
x = length(unique(diverging_data$Continent)) - 0.5,
y = avg_growing + 2,
label = paste0("Global Average: ", round(avg_growing, 1), "%"),
color = "#2C3E50",
fontface = "bold",
size = 3.5
) +
scale_fill_manual(
values = diverging_colors,
labels = c("Below Average", "Above Average"),
name = "Compared to Global Average"
) +
labs(
title = "CONTINENTS VS GLOBAL AVERAGE",
subtitle = "Shows which continents have above/below average growth percentages\nRed-Blue gradient indicates performance",
x = "Continent",
y = "% of Countries Growing",
caption = "Story: Continental performance compared to global average"
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 16, hjust = 0.5, color = "#2C3E50"),
plot.subtitle = element_text(size = 11, hjust = 0.5, color = "#7F8C8D", margin = margin(b=10)),
axis.title = element_text(face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "bottom",
panel.grid.major = element_line(color = "gray95"),
panel.grid.minor = element_blank()
) +
# Add value labels
geom_text(
aes(y = Percent_Growing, label = paste0(round(Percent_Growing, 1), "%")),
vjust = -0.5,
color = "#2C3E50",
fontface = "bold",
size = 4
)
print(diverging_bar)
ggsave("diverging_bar_gradient.png", diverging_bar, width = 10, height = 7)
# Prepare data for pyramid
pyramid_data <- population_data %>%
mutate(
# For pyramid, we need growing on positive side, declining on negative
Count = ifelse(Growth_Status == "Growing", 1, -1)
) %>%
group_by(Continent, Growth_Status) %>%
summarise(Count = n(), .groups = 'drop') %>%
mutate(
Count = ifelse(Growth_Status == "Declining", -Count, Count)
)
pyramid_colors <- c("Growing" = "#9B59B6", "Declining" = "#F39C12") # Purple-Orange gradient
pyramid_bar <- ggplot(pyramid_data, aes(x = Continent, y = Count, fill = Growth_Status)) +
geom_bar(stat = "identity", position = "identity") +
# Flip coordinates for pyramid effect
coord_flip() +
# Custom y-axis to show positive and negative
scale_y_continuous(
breaks = seq(-50, 50, by = 10),
labels = function(x) ifelse(x < 0, paste0(abs(x), " Declining"),
ifelse(x > 0, paste0(x, " Growing"), "0"))
) +
scale_fill_manual(values = pyramid_colors) +
labs(
title = "PYRAMID COMPARISON",
subtitle = "Growing countries on right (positive), Declining on left (negative)\nPurple-Orange gradient for visual separation",
x = "Continent",
y = "Number of Countries",
fill = "Growth Status",
caption = "Story: Direct side-by-side comparison of growing vs declining counts"
) +
theme_minimal() +
theme(
plot.title = element_text(face = "bold", size = 16, hjust = 0.5, color = "#2C3E50"),
plot.subtitle = element_text(size = 11, hjust = 0.5, color = "#7F8C8D", margin = margin(b=10)),
axis.title = element_text(face = "bold"),
axis.text.y = element_text(face = "bold"),
legend.position = "bottom",
panel.grid.major.x = element_line(color = "gray95"),
panel.grid.minor = element_blank(),
plot.background = element_rect(fill = "#F8F9FA", color = NA)
) +
# Add value labels
geom_text(
aes(
label = ifelse(Count > 0, Count, -Count),
hjust = ifelse(Count > 0, -0.2, 1.2)
),
color = "white",
fontface = "bold",
size = 4
) +
# Center line
geom_hline(yintercept = 0, color = "#2C3E50", size = 1)
print(pyramid_bar)
ggsave("pyramid_stacked_gradient.png", pyramid_bar, width = 10, height = 7)
ggsave("diverging_bar_gradient.png", diverging_bar, width = 10, height = 7)
ggsave("diverging_bar_gradient.png", diverging_bar, width = 10, height = 7)
========================
ggsave("diverging_bar_gradient.png", diverging_bar, width = 10, height = 7)
========================
# Prepare data
population_data <- read.csv("population_data.csv")
population_data$Yearly_Change_Numeric <- as.numeric(
gsub("%", "", gsub("−", "-", population_data$Yearly.Change))
)
population_data$Growth_Status <- ifelse(
population_data$Yearly_Change_Numeric > 0, "Growing", "Declining"
)
library(countrycode)
population_data$Continent <- countrycode(
sourcevar = population_data$Country..or.dependency.,
origin = "country.name",
destination = "continent",
warn = FALSE
)
population_data$Continent[is.na(population_data$Continent)] <- "Other"
# Story: "Which continents dominate population growth?"
# Calculate growth momentum
story1_data <- population_data %>%
group_by(Continent, Growth_Status) %>%
summarise(
Count = n(),
Total_Population = sum(Population..2024., na.rm = TRUE),
Avg_Yearly_Change = mean(Yearly_Change_Numeric, na.rm = TRUE),
.groups = 'drop'
) %>%
mutate(
# Calculate "growth momentum" score
Momentum_Score = ifelse(Growth_Status == "Growing",
Count * (1 + Avg_Yearly_Change/100),
Count * (1 - Avg_Yearly_Change/100))
) %>%
group_by(Continent) %>%
mutate(
Total_Continent_Count = sum(Count),
Growth_Percentage = ifelse(Growth_Status == "Growing",
Count / Total_Continent_Count * 100, 0)
)
