# Calculate growth hierarchy
story3_data <- population_data %>%
group_by(Continent) %>%
summarise(
Total = n(),
Growing = sum(Growth_Status == "Growing"),
Declining = sum(Growth_Status == "Declining"),
.groups = 'drop'
) %>%
mutate(
Growth_Ratio = Growing / (Growing + Declining),
# Create hierarchy levels
Hierarchy_Level = case_when(
Growth_Ratio >= 0.8 ~ "Very High Growth",
Growth_Ratio >= 0.6 ~ "High Growth",
Growth_Ratio >= 0.4 ~ "Moderate Growth",
Growth_Ratio >= 0.2 ~ "Low Growth",
TRUE ~ "Very Low Growth"
)
) %>%
arrange(desc(Growth_Ratio))
# Create hierarchy gradient colors
hierarchy_colors <- c(
"Very High Growth" = "#006400",    # Dark green
"High Growth" = "#228B22",         # Forest green
"Moderate Growth" = "#32CD32",     # Lime green
"Low Growth" = "#90EE90",          # Light green
"Very Low Growth" = "#FFB6C1"      # Light pink (for contrast)
)
story3_plot <- ggplot(story3_data,
aes(x = reorder(Continent, -Growth_Ratio),
y = Total)) +
# Background bar (total countries)
geom_col(fill = "#F5F5F5", alpha = 0.3, width = 0.7) +
# Growing countries (stacked on top)
geom_col(aes(y = Growing, fill = Hierarchy_Level),
width = 0.7, alpha = 0.9) +
# Add texture gradient to growing bars
geom_col(aes(y = Growing, alpha = Growth_Ratio),
fill = "white", width = 0.7, show.legend = FALSE) +
scale_fill_manual(values = hierarchy_colors, name = "Growth Level") +
scale_alpha_continuous(range = c(0, 0.4)) +
# Add labels for growing countries
geom_text(
aes(y = Growing, label = paste0(Growing, "/", Total)),
vjust = -0.5,
color = "#2C3E50",
fontface = "bold",
size = 4
) +
# Add percentage labels inside bars
geom_text(
aes(y = Growing/2,
label = paste0(round(Growth_Ratio * 100, 0), "%")),
color = "white",
fontface = "bold",
size = 4.5
) +
# Titles and labels
labs(
title = "GROWTH DOMINANCE HIERARCHY",
subtitle = "Shows growth hierarchy across continents\nDark green = Very High Growth, Light green = Low Growth",
x = "Continent (Ordered by Growth %)",
y = "Number of Countries",
caption = "Story: Hierarchy of growth dominance across continents"
) +
theme_minimal(base_size = 13) +
theme(
plot.title = element_text(face = "bold", size = 18, hjust = 0.5, color = "#2C3E50"),
plot.subtitle = element_text(size = 12, hjust = 0.5, color = "#7F8C8D", margin = margin(b = 15)),
axis.title = element_text(face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, face = "bold", size = 11),
legend.position = "bottom",
panel.grid.major.x = element_blank(),
panel.grid.minor = element_blank(),
plot.background = element_rect(fill = "white", color = NA)
) +
scale_y_continuous(expand = expansion(mult = c(0, 0.1)))
print(story3_plot)
ggsave("story3_growth_hierarchy_gradient.png", story3_plot, width = 11, height = 8, dpi = 300)
story4_data <- population_data %>%
group_by(Continent) %>%
summarise(
Growing = sum(Growth_Status == "Growing"),
Declining = sum(Growth_Status == "Declining"),
Total = n(),
.groups = 'drop'
) %>%
mutate(
# Create pattern categories based on distribution
Pattern_Type = case_when(
Growing >= Declining * 2 ~ "Heavily Growing",
Growing > Declining ~ "Moderately Growing",
Growing == Declining ~ "Balanced",
Declining > Growing ~ "Moderately Declining",
Declining >= Growing * 2 ~ "Heavily Declining"
)
) %>%
arrange(desc(Growing))
# Create pattern gradient colors
pattern_colors <- c(
"Heavily Growing" = "#00441B",     # Very dark green
"Moderately Growing" = "#238B45",  # Medium green
"Balanced" = "#FFD700",            # Gold
"Moderately Declining" = "#CB181D", # Medium red
"Heavily Declining" = "#67000D"    # Very dark red
)
# Create a stacked bar with pattern overlay effect
story4_plot <- ggplot(story4_data) +
# Base bars (Total)
geom_col(aes(x = reorder(Continent, -Total), y = Total),
fill = "#F0F0F0", width = 0.7, alpha = 0.5) +
# Declining countries (bottom stack)
geom_col(aes(x = reorder(Continent, -Total), y = Declining),
fill = "#FF6B6B", width = 0.7, alpha = 0.7) +
# Growing countries (top stack)
geom_col(aes(x = reorder(Continent, -Total), y = Growing),
fill = "#4ECDC4", width = 0.7, alpha = 0.7,
position = position_nudge(y = story4_data$Declining)) +
# Pattern overlay based on Pattern_Type
geom_tile(
aes(x = as.numeric(reorder(Continent, -Total)),
y = Total/2,
width = 0.5,
height = Total,
fill = Pattern_Type),
alpha = 0.2
) +
scale_fill_manual(values = pattern_colors, name = "Distribution Pattern") +
# Add connecting lines to show the split
geom_segment(
aes(x = as.numeric(reorder(Continent, -Total)) - 0.35,
xend = as.numeric(reorder(Continent, -Total)) + 0.35,
y = Declining,
yend = Declining),
color = "gray40",
linetype = "dashed",
size = 0.5
) +
# Labels for growing
geom_text(
aes(x = reorder(Continent, -Total),
y = Declining + Growing/2,
label = paste0("G:", Growing)),
color = "white",
fontface = "bold",
size = 4
) +
# Labels for declining
geom_text(
aes(x = reorder(Continent, -Total),
y = Declining/2,
label = paste0("D:", Declining)),
color = "white",
fontface = "bold",
size = 4
) +
# Pattern type labels
geom_text(
aes(x = reorder(Continent, -Total),
y = Total + max(story4_data$Total) * 0.05,
label = Pattern_Type),
color = "#2C3E50",
fontface = "bold",
size = 3.5
) +
# Titles and labels
labs(
title = "GROWTH DISTRIBUTION PATTERNS",
subtitle = "Shows different distribution patterns of growth across continents\nBlue = Growing, Red = Declining, Pattern overlay shows distribution type",
x = "Continent (Ordered by Total Countries)",
y = "Number of Countries",
caption = "Story: Different patterns of growth distribution across continents"
) +
theme_minimal(base_size = 13) +
theme(
plot.title = element_text(face = "bold", size = 18, hjust = 0.5, color = "#2C3E50"),
plot.subtitle = element_text(size = 12, hjust = 0.5, color = "#7F8C8D", margin = margin(b = 15)),
axis.title = element_text(face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, face = "bold", size = 11),
legend.position = "bottom",
panel.grid.major.x = element_blank(),
panel.grid.minor = element_blank(),
plot.background = element_rect(fill = "white", color = NA)
) +
scale_y_continuous(expand = expansion(mult = c(0, 0.15)))
print(story4_plot)
ggsave("story4_growth_patterns_gradient.png", story4_plot, width = 11, height = 8, dpi = 300)
print(diverging_bar)
print(story3_plot)
# Calculate growth hierarchy
story3_data <- population_data %>%
group_by(Continent) %>%
summarise(
Total = n(),
Growing = sum(Growth_Status == "Growing"),
Declining = sum(Growth_Status == "Declining"),
.groups = 'drop'
) %>%
mutate(
Growth_Ratio = Growing / (Growing + Declining),
# Create hierarchy levels
Hierarchy_Level = case_when(
Growth_Ratio >= 0.8 ~ "Very High Growth",
Growth_Ratio >= 0.6 ~ "High Growth",
Growth_Ratio >= 0.4 ~ "Moderate Growth",
Growth_Ratio >= 0.2 ~ "Low Growth",
TRUE ~ "Very Low Growth"
)
) %>%
arrange(desc(Growth_Ratio))
install.packages("tidyverse")  # For data manipulation
install.packages("countrycode") # For country-to-continent mapping
install.packages("ggplot2")     # For visualizations
install.packages("dplyr")
install.packages("viridis")
# Load libraries
library(tidyverse)
library(countrycode)
library(ggplot2)
library(dplyr)
library(viridis)
cat("✅ Libraries loaded successfully!\n")
population_data <- read.csv("population_data.csv")
# Basic dataset information
cat("=== DATASET OVERVIEW ===\n")
cat("Total countries:", nrow(population_data), "\n")
cat("Variables available:\n")
print(names(population_data))
# View structure of the dataset
str(population_data)
head(population_data, 3)
# Check for missing values
missing_values <- sum(is.na(population_data))
cat("\nTotal missing values:", missing_values, "\n")
cat("=== CHECKING YEARLY CHANGE VALUES ===\n")
print(head(population_data$Yearly.Change, 10))
# Converting Yearly Change to numeric (handle special minus sign)
# Replacing the special minus sign with regular minus
population_data$Yearly_Change_Numeric <- gsub("−", "-", population_data$Yearly.Change)
# Removing the % sign
population_data$Yearly_Change_Numeric <- gsub("%", "", population_data$Yearly_Change_Numeric)
# Converting to numeric
population_data$Yearly_Change_Numeric <- as.numeric(population_data$Yearly_Change_Numeric)
# Creating Growth Status
population_data$Growth_Status <- ifelse(
population_data$Yearly_Change_Numeric > 0,
"Growing",
"Declining")
table(population_data$Growth_Status)
# Testing with the first few rows
test_rows <- population_data[1:10, ]
test_rows$Growth_Status <- ifelse(
as.numeric(gsub("%", "", gsub("−", "-", test_rows$Yearly.Change))) > 0,
"Growing",
"Declining")
cat("=== TEST RESULTS (First 10 rows) ===\n")
print(test_rows[, c("Country..or.dependency.", "Yearly.Change", "Growth_Status")])
# First, let's create the continent mapping using countrycode
population_data$Continent <- countrycode(
sourcevar = population_data$Country..or.dependency.,
origin = "country.name",
destination = "continent",
warn = FALSE
)
# Handle any countries that couldn't be mapped
na_continent <- sum(is.na(population_data$Continent))
if(na_continent > 0) {
cat("Countries without continent assignment:", na_continent, "\n")
# Assign "Other" for unmapped countries
population_data$Continent[is.na(population_data$Continent)] <- "Other"
}
# Check continent distribution
cat("\n=== CONTINENT DISTRIBUTION ===\n")
continent_table <- table(population_data$Continent)
print(continent_table)
# Calculate growth hierarchy
story3_data <- population_data %>%
group_by(Continent) %>%
summarise(
Total = n(),
Growing = sum(Growth_Status == "Growing"),
Declining = sum(Growth_Status == "Declining"),
.groups = 'drop'
) %>%
mutate(
Growth_Ratio = Growing / (Growing + Declining),
# Create hierarchy levels
Hierarchy_Level = case_when(
Growth_Ratio >= 0.8 ~ "Very High Growth",
Growth_Ratio >= 0.6 ~ "High Growth",
Growth_Ratio >= 0.4 ~ "Moderate Growth",
Growth_Ratio >= 0.2 ~ "Low Growth",
TRUE ~ "Very Low Growth"
)
) %>%
arrange(desc(Growth_Ratio))
# NEW: Create gradient colors from blue to purple
hierarchy_colors <- c(
"Very High Growth" = "#1a237e",    # Deep blue (darkest)
"High Growth" = "#283593",         # Royal blue
"Moderate Growth" = "#3949ab",     # Medium blue
"Low Growth" = "#5c6bc0",          # Light blue
"Very Low Growth" = "#7986cb"      # Lavender blue (lightest)
)
story3_plot <- ggplot(story3_data,
aes(x = reorder(Continent, -Growth_Ratio),
y = Total)) +
# Background bar (total countries) - changed to light blue
geom_col(fill = "#f5f7ff", alpha = 0.3, width = 0.7) +
# Growing countries (stacked on top)
geom_col(aes(y = Growing, fill = Hierarchy_Level),
width = 0.7, alpha = 0.9) +
# Add texture gradient to growing bars
geom_col(aes(y = Growing, alpha = Growth_Ratio),
fill = "white", width = 0.7, show.legend = FALSE) +
scale_fill_manual(values = hierarchy_colors, name = "Growth Level") +
scale_alpha_continuous(range = c(0, 0.3)) +  # Reduced alpha for better color visibility
# Add labels for growing countries - changed text color for better contrast
geom_text(
aes(y = Growing, label = paste0(Growing, "/", Total)),
vjust = -0.5,
color = "#1a237e",  # Dark blue for contrast
fontface = "bold",
size = 4
) +
# Add percentage labels inside bars - changed to white for better readability
geom_text(
aes(y = Growing/2,
label = paste0(round(Growth_Ratio * 100, 0), "%")),
color = "white",
fontface = "bold",
size = 4.5
) +
# Titles and labels - updated to reflect new colors
labs(
title = "GROWTH DOMINANCE HIERARCHY",
subtitle = "Shows growth hierarchy across continents\nDark blue = Very High Growth, Light blue = Low Growth",
x = "Continent (Ordered by Growth %)",
y = "Number of Countries",
caption = "Story: Hierarchy of growth dominance across continents | Blue-Purple gradient"
) +
theme_minimal(base_size = 13) +
theme(
plot.title = element_text(face = "bold", size = 18, hjust = 0.5, color = "#1a237e"),
plot.subtitle = element_text(size = 12, hjust = 0.5, color = "#5c6bc0", margin = margin(b = 15)),
axis.title = element_text(face = "bold", color = "#283593"),
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, face = "bold", size = 11, color = "#3949ab"),
axis.text.y = element_text(color = "#3949ab"),
legend.position = "bottom",
legend.title = element_text(face = "bold", color = "#1a237e"),
legend.text = element_text(color = "#3949ab"),
panel.grid.major.x = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_line(color = "#e8eaf6"),
plot.background = element_rect(fill = "#fafbff", color = NA),
panel.background = element_rect(fill = "#f5f7ff", color = NA)
) +
# Add subtle outline to bars for definition
geom_col(aes(y = Growing),
fill = NA,
color = "#1a237e",
size = 0.3,
width = 0.7) +
scale_y_continuous(expand = expansion(mult = c(0, 0.1)))
print(story3_plot)
# Calculate growth hierarchy and remove "Other" category
story3_data <- population_data %>%
filter(Continent != "Other") %>%  # Remove "Other" category
group_by(Continent) %>%
summarise(
Total = n(),
Growing = sum(Growth_Status == "Growing"),
Declining = sum(Growth_Status == "Declining"),
.groups = 'drop'
) %>%
mutate(
Growth_Ratio = Growing / (Growing + Declining),
# Create hierarchy levels
Hierarchy_Level = case_when(
Growth_Ratio >= 0.8 ~ "Very High Growth",
Growth_Ratio >= 0.6 ~ "High Growth",
Growth_Ratio >= 0.4 ~ "Moderate Growth",
Growth_Ratio >= 0.2 ~ "Low Growth",
TRUE ~ "Very Low Growth"
)
) %>%
arrange(desc(Growth_Ratio))
print("Filtered Data (without 'Other' category):")
print(story3_data)
# Create a vibrant rainbow gradient for the hierarchy levels
hierarchy_colors <- c(
"Very High Growth" = "#FF0000",    # Red (hottest)
"High Growth" = "#FF8000",         # Orange
"Moderate Growth" = "#FFFF00",     # Yellow
"Low Growth" = "#00FF00",          # Green
"Very Low Growth" = "#0000FF"      # Blue (coldest)
)
story3_plot <- ggplot(story3_data,
aes(x = reorder(Continent, -Growth_Ratio),
y = Total)) +
# Background bar (total countries) - use subtle gradient
geom_col(fill = "#F0F0F0", alpha = 0.3, width = 0.7) +
# Growing countries (stacked on top) with vibrant gradient
geom_col(aes(y = Growing, fill = Hierarchy_Level),
width = 0.7, alpha = 0.9) +
# Add subtle gradient overlay for more vibrant effect
geom_col(aes(y = Growing),
fill = "white",
alpha = 0.1,
width = 0.7) +
# VIBRANT RAINBOW GRADIENT SCALE
scale_fill_manual(
values = hierarchy_colors,
name = "Growth Level",
guide = guide_legend(reverse = TRUE)  # Reverse legend to match bar order
) +
# Add labels for growing countries - bold black for contrast
geom_text(
aes(y = Growing, label = paste0(Growing, "/", Total)),
vjust = -0.5,
color = "black",
fontface = "bold",
size = 4.5
) +
# Add percentage labels inside bars - white for readability
geom_text(
aes(y = Growing/2,
label = paste0(round(Growth_Ratio * 100, 0), "%")),
color = "white",
fontface = "bold",
size = 5,
alpha = 0.9
) +
# Titles and labels
labs(
title = "CONTINENTAL GROWTH HIERARCHY",
subtitle = "Vibrant rainbow gradient shows growth intensity across continents\nRed (Very High) → Orange → Yellow → Green → Blue (Very Low)",
x = "Continent (Ranked by Growth Percentage)",
y = "Number of Countries",
caption = "Data Analysis: Population Growth Status by Continent"
) +
theme_minimal(base_size = 14) +
theme(
plot.title = element_text(
face = "bold",
size = 20,
hjust = 0.5,
color = "#333333",
margin = margin(b = 10)
),
plot.subtitle = element_text(
size = 13,
hjust = 0.5,
color = "#666666",
margin = margin(b = 20)
),
axis.title = element_text(
face = "bold",
size = 13,
color = "#333333"
),
axis.text.x = element_text(
angle = 45,
hjust = 1,
vjust = 1,
face = "bold",
size = 12,
color = "#333333"
),
axis.text.y = element_text(
size = 11,
color = "#333333"
),
legend.position = "bottom",
legend.title = element_text(
face = "bold",
size = 12,
color = "#333333"
),
legend.text = element_text(
size = 11,
color = "#333333"
),
legend.key.size = unit(1, "cm"),
panel.grid.major.x = element_blank(),
panel.grid.minor = element_blank(),
panel.grid.major.y = element_line(color = "#E0E0E0", size = 0.5),
plot.background = element_rect(fill = "white", color = NA),
panel.background = element_rect(fill = "white", color = NA),
plot.margin = margin(20, 20, 20, 20)
) +
# Add subtle glow effect to bars
geom_col(
aes(y = Growing),
fill = NA,
color = "white",
size = 1,
width = 0.71,
alpha = 0.3
) +
# Ensure y-axis shows proper range
scale_y_continuous(
expand = expansion(mult = c(0, 0.15)),
breaks = seq(0, 60, by = 10),
limits = c(0, max(story3_data$Total) * 1.15)
)
print(story3_plot)
ggsave("vibrant_growth_hierarchy_gradient.png", story3_plot, width = 12, height = 8, dpi = 300)
print(story3_plot)
print(story4_plot)
print(story2_plot)
